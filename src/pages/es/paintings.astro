---
import Layout from "@layouts/Layout.astro";
import PageHeader from "@components/astro/PageHeader.astro";
import GalleryGrid from "@components/react/GalleryGrid";
import { t } from "@/i18n";
import { getImage } from "astro:assets";
import type { ImageMetadata } from "astro";

// Recent paintings
import danceInTheSnow from "@assets/images/recent-paintings/dance-in-the-snow.webp";
import fruitVendors from "@assets/images/recent-paintings/fruit-vendors.webp";
import landscapeII from "@assets/images/recent-paintings/landscape-II.webp";
import landscapeIV from "@assets/images/recent-paintings/landscape-IV.webp";
import landscape from "@assets/images/recent-paintings/landscape.webp";
import marketVendor from "@assets/images/recent-paintings/market-vendor.webp";

// Island paintings
import isla from "@assets/images/paintings/isla.webp";
import ometepe from "@assets/images/paintings/ometepe.webp";

// Figurative
import boy from "@assets/images/paintings/boy.webp";
import leon from "@assets/images/paintings/leon.webp";
import boyWithGourds from "@assets/images/paintings/boywithgourds.webp";

// Landscapes
import housesVolcano from "@assets/images/paintings/houses-volcano.webp";
import yellowSky from "@assets/images/paintings/yellow-sky.webp";

// Still life
import fruit from "@assets/images/paintings/fruit.webp";
import cuadro from "@assets/images/paintings/Cuadro.webp";

// Abstract
import colorfulShapes from "@assets/images/paintings/colorful-shapes.webp";

// Other works
import oilOnCanvas from "@assets/images/paintings/oil-on-canvas.webp";
import horses from "@assets/images/paintings/horses.webp";
import village from "@assets/images/paintings/village.webp";
import flores from "@assets/images/recent-paintings/flores.webp";
import floresII from "@assets/images/recent-paintings/flores-II.webp";

const locale = "es";

const SIZES = "(min-width: 1024px) 400px, (min-width: 640px) 50vw, 100vw";

async function processPainting(
  img: ImageMetadata,
  alt: string,
  title: string,
  objectPosition?: string,
) {
  const targetWidths = [400, 800].filter((w) => w < img.width);
  const variants = await Promise.all(
    targetWidths.map(async (w) => {
      const result = await getImage({ src: img, width: w });
      return `${result.src} ${w}w`;
    }),
  );
  variants.push(`${img.src} ${img.width}w`);

  return {
    src: img.src,
    srcSet: variants.join(", "),
    sizes: SIZES,
    alt,
    title,
    width: img.width,
    height: img.height,
    ...(objectPosition && { objectPosition }),
  };
}

const paintings = await Promise.all([
  processPainting(danceInTheSnow, "Baile en la nieve", "Baile en la Nieve"),
  processPainting(fruitVendors, "Vendedoras de frutas en el mercado", "Vendedoras de Frutas", "top"),
  processPainting(landscape, "Pintura de paisaje", "Paisaje"),
  processPainting(landscapeII, "Pintura de paisaje II", "Paisaje II"),
  processPainting(landscapeIV, "Pintura de paisaje IV", "Paisaje IV"),
  processPainting(marketVendor, "Vendedora del mercado", "Vendedora del Mercado", "top"),
  processPainting(isla, "Pintura de la Isla de Ometepe", "Isla de Ometepe"),
  processPainting(ometepe, "Vista del volcán Ometepe", "Ometepe"),
  processPainting(boy, "Niño cargando agua", "Niño Cargando Agua", "top"),
  processPainting(leon, "Escena callejera de León con techos de teja", "León"),
  processPainting(boyWithGourds, "Niño con tinajas y mangos", "Niño con Tinajas"),
  processPainting(housesVolcano, "Casas con volcán de fondo", "Casas y Volcán"),
  processPainting(yellowSky, "Casas bajo cielo amarillo", "Cielo Amarillo"),
  processPainting(fruit, "Naturaleza muerta con frutas", "Frutas"),
  processPainting(cuadro, "Composición de naturaleza muerta", "Cuadro"),
  processPainting(colorfulShapes, "Formas coloridas abstractas", "Formas Coloridas"),
  processPainting(oilOnCanvas, "Pintura al óleo sobre lienzo", "Óleo sobre Lienzo"),
  processPainting(horses, "Pintura de caballos", "Caballos"),
  processPainting(village, "Pueblo con casas de techos de teja", "Pueblo"),
  processPainting(flores, "Flores coloridas sobre fondo negro", "Flores"),
  processPainting(floresII, "Flores en un jarrón", "Flores II"),
]);
---

<Layout metaTitle={t(locale, "paintings.title")}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-16">
    <PageHeader title={t(locale, "paintings.title")} />
    <p class="gallery-hint">
      <svg
        class="hint-icon"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="1.5"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.3-4.3"></path>
        <path d="M11 8v6"></path>
        <path d="M8 11h6"></path>
      </svg>
      {t(locale, "paintings.hint")}
    </p>
    <GalleryGrid paintings={paintings} client:load />
  </div>
</Layout>

<style>
  .gallery-hint {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    font-family: var(--font-sans);
    font-size: 0.875rem;
    color: var(--text-secondary);
    letter-spacing: 0.02em;
    margin-bottom: 2rem;
    opacity: 0.8;
  }

  .hint-icon {
    opacity: 0.7;
  }
</style>
