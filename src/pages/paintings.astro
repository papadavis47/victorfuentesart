---
import Layout from "@layouts/Layout.astro";
import PageHeader from "@components/astro/PageHeader.astro";
import GalleryGrid from "@components/react/GalleryGrid";
import { getImage } from "astro:assets";
import type { ImageMetadata } from "astro";

// Recent paintings
import danceInTheSnow from "@assets/images/recent-paintings/dance-in-the-snow.webp";
import fruitVendors from "@assets/images/recent-paintings/fruit-vendors.webp";
import landscapeII from "@assets/images/recent-paintings/landscape-II.webp";
import landscapeIV from "@assets/images/recent-paintings/landscape-IV.webp";
import landscape from "@assets/images/recent-paintings/landscape.webp";
import marketVendor from "@assets/images/recent-paintings/market-vendor.webp";

// Island paintings
import isla from "@assets/images/paintings/isla.webp";
import ometepe from "@assets/images/paintings/ometepe.webp";

// Figurative
import boy from "@assets/images/paintings/boy.webp";
import leon from "@assets/images/paintings/leon.webp";
import boyWithGourds from "@assets/images/paintings/boywithgourds.webp";

// Landscapes
import housesVolcano from "@assets/images/paintings/houses-volcano.webp";
import yellowSky from "@assets/images/paintings/yellow-sky.webp";

// Still life
import fruit from "@assets/images/paintings/fruit.webp";
import cuadro from "@assets/images/paintings/Cuadro.webp";

// Abstract
import colorfulShapes from "@assets/images/paintings/colorful-shapes.webp";

// Other works
import oilOnCanvas from "@assets/images/paintings/oil-on-canvas.webp";
import horses from "@assets/images/paintings/horses.webp";
import village from "@assets/images/paintings/village.webp";
import flores from "@assets/images/recent-paintings/flores.webp";
import floresII from "@assets/images/recent-paintings/flores-II.webp";

const SIZES = "(min-width: 1024px) 400px, (min-width: 640px) 50vw, 100vw";

async function processPainting(
  img: ImageMetadata,
  alt: string,
  title: string,
  objectPosition?: string,
) {
  const targetWidths = [400, 800].filter((w) => w < img.width);
  const variants = await Promise.all(
    targetWidths.map(async (w) => {
      const result = await getImage({ src: img, width: w });
      return `${result.src} ${w}w`;
    }),
  );
  variants.push(`${img.src} ${img.width}w`);

  return {
    src: img.src,
    srcSet: variants.join(", "),
    sizes: SIZES,
    alt,
    title,
    width: img.width,
    height: img.height,
    ...(objectPosition && { objectPosition }),
  };
}

const paintings = await Promise.all([
  processPainting(danceInTheSnow, "Dance in the snow", "Dance in the Snow"),
  processPainting(fruitVendors, "Fruit vendors at market", "Fruit Vendors", "top"),
  processPainting(landscape, "Landscape painting", "Landscape"),
  processPainting(landscapeII, "Landscape painting II", "Landscape II"),
  processPainting(landscapeIV, "Landscape painting IV", "Landscape IV"),
  processPainting(marketVendor, "Market vendor", "Market Vendor", "top"),
  processPainting(isla, "Island of Ometepe painting", "Isla de Ometepe"),
  processPainting(ometepe, "View of Ometepe volcano", "Ometepe"),
  processPainting(boy, "Boy carrying water", "Boy Carrying Water", "top"),
  processPainting(leon, "León street scene with tile roofs", "León"),
  processPainting(boyWithGourds, "Boy with gourds and mangoes", "Boy with Gourds"),
  processPainting(housesVolcano, "Houses with volcano backdrop", "Houses and Volcano"),
  processPainting(yellowSky, "Houses under yellow sky", "Yellow Sky"),
  processPainting(fruit, "Still life with fruit", "Fruit"),
  processPainting(cuadro, "Still life composition", "Cuadro"),
  processPainting(colorfulShapes, "Abstract colorful shapes", "Colorful Shapes"),
  processPainting(oilOnCanvas, "Oil painting on canvas", "Oil on Canvas"),
  processPainting(horses, "Horses painting", "Horses"),
  processPainting(village, "Village with tile-roofed houses", "Village"),
  processPainting(flores, "Colorful flowers on black background", "Flowers"),
  processPainting(floresII, "Flowers in a vase", "Flowers II"),
]);
---

<Layout metaTitle="Paintings">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-16">
    <PageHeader title="Paintings" />
    <p class="gallery-hint">
      <svg
        class="hint-icon"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="1.5"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.3-4.3"></path>
        <path d="M11 8v6"></path>
        <path d="M8 11h6"></path>
      </svg>
      Click any image to view larger
    </p>
    <GalleryGrid paintings={paintings} client:load />
  </div>
</Layout>

<style>
  .gallery-hint {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    font-family: var(--font-sans);
    font-size: 0.875rem;
    color: var(--text-secondary);
    letter-spacing: 0.02em;
    margin-bottom: 2rem;
    opacity: 0.8;
  }

  .hint-icon {
    opacity: 0.7;
  }
</style>
